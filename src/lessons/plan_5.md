# Модуль 3

## Занятие 5:

- Ответы на вопросы
- Кахут
- Теория:
  - [Жизненный цикл компонента](http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/)
  - Методы жизненного цикла компонент-классов
  - Сохранение коллекции заметок в localStorage (componentDidMount и
    componentDidUpdate)
  - Модальное окно (componentDidMount и componentWillUnmount)
  - [Таймер и утечка памяти с setState() без componentWillUnmount](https://youtu.be/w6MW1szKuT4?t=2894)
  - [Табы (shouldComponentUpdate)](https://youtu.be/w6MW1szKuT4?t=3289)
  - библиотеки - всплывающие уведомления:
    [react-toastify](https://www.npmjs.com/package/react-toastify),
    [react-hot-toast](https://www.npmjs.com/package/react-hot-toast)

### Задача № 1

Показать стандартные методы жизненого цикла компонента в классах на компоненте
`AddForm`

### Задача № 2

Все колекции преподавателей, городрв, факультетов записывать в localStorage

- в компоненте `CitiesBlock` импортируем функции `storage` из сервисов
- при изменении компонента проверяем, если свойство `cities` в стейте изменится,
  нужно записать текущее его значение в `localStorage`

### Задача № 3

Все колекции преподавателей, городов, факультетов cчитывать с `localStorage` при
первой загрузке страницы

- при монтировании компонента `CitiesBlock` cчитываем с `localStorage` массив
  сохраненных городов
- если сохраненные города есть, нужно записать их в стейт

### Задача № 4

Для компонента `Modal` добавить возможность закрытия по кнопке `ESC`:

- пишем метод `handleKeydown`, в котором закрываем модалку, если была нажата
  клавиша `ESC`
- при монтировании модалки вешаем слушателя события на `window`
- при размонтировании - снимаем

### Задача № 5

Реализовать рендер `Modal` в портале:

- добавляем новый див в index.html с id modal-root, например
- в компоненте `Modal` импортируем метод createPortal из 'react-dom'
- получаем ссылку на новый див из ДОМа через обычный querySelector
- теперь все, что возвращалось в методе render, передаем первым аргументом в
  функцию createPortal, а вторым ссылочку на див
- и теперь возвращаем вызов этой функции

### Задача № 6

Переписать логику с несколькими полями в стейте для разных модалок на одно общее
поле с разными состояниями. Для состояний использовать словарь:

```
const MODAL = {
  NONE: 'none',
  EDIT: 'edit',
  DELETE: 'delete',
};
```

- в компоненте `CitiesBlock` оставляем только одно поле в стейте для модалок
  `openedModal: MODAL.NONE`
- переписываем методы для закрытия разных модалок на один общий
- модалки рендерим, сравнивая значение поля `openedModal` с соответствующими
  состояниями

### Задача № 7

Таймер и утечка памяти с setState() без componentWillUnmount:

- в компоненте `AddForm` будем рендерить Timer
- при закрытии формы получим предупреждение
- чтобы решить проблему, нужно остановить интервал перед размонтированием
  таймера
- для этого создадим в классе свойство intervalId = null;

### Дополнительно

- в компоненте `CitiesBlock` рендерить фильтр только если есть хотя бы 2 города
  в массиве городов
- рендерить список городов только, если есть хотя бы один город в массиве
  отфильтрованных городов

### Советы по ДЗ

- как работать с фетч вместе с componentDidUpdate
- как открывать модалку на фото (поле modalImg)
- уведомления
- методы жизненного цикла принято располагать сразу за стейтом, вверху класса
- методы жизненного цикла желательно не перегружать и выносить код в отдельные
  методы
